\subsection{data2packets\+\_\+top\+\_\+tb.\+vhd}
\label{data2packets__top__tb_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/rx\+\_\+path\+\_\+top/data2packets/sim/data2packets\+\_\+top\+\_\+tb.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/rx\+\_\+path\+\_\+top/data2packets/sim/data2packets\+\_\+top\+\_\+tb.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00002 \textcolor{keyword}{-- FILE:    data2packets\_top\_tb.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION: }
00004 \textcolor{keyword}{-- DATE:    Feb 13, 2014}
00005 \textcolor{keyword}{-- AUTHOR(s):   Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00008 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00009 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00010 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00011 
00012 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00013 \textcolor{keyword}{-- Entity declaration}
00014 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00015 \textcolor{keywordflow}{entity }data2packets_top_tb \textcolor{keywordflow}{is}
00016 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{data2packets\_top\_tb};
00017 
00018 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00019 \textcolor{keyword}{-- Architecture}
00020 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00021 
00022 \textcolor{keywordflow}{architecture} tb\_behave \textcolor{keywordflow}{of} data2packets_top_tb is
00023 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk0_period}          \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns};
00024 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk1_period}          \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns}; 
00025 \textcolor{keyword}{   --signals}
00026 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{,}\textcolor{vhdlchar}{clk1}                 \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00027 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{reset_n}                \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic}; 
00028    
00029 \textcolor{keyword}{--dut0 signals}
00030 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_sample_width}      \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{"10"};\textcolor{keyword}{ --"10"-12bit, "01"-14bit, "00"-16bit;}
00031 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_hdr_0}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{:=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00032 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_hdr_1}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};         
00033 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_buff_wrreq}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00034 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_buff_wrdata}   \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00035 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_smpl_buff_rdreq}   \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00036 
00037 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{smpl_fifo_size}         \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{11};
00038 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_fifo_size}          \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{12};
00039 
00040 \textcolor{keyword}{--inst1}
00041 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_wrreq}            \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00042 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_data}             \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{47} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00043 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_q}                \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{47} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00044 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_rdusedw}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00045 
00046 \textcolor{keyword}{--inst2 }
00047 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst2_wrusedw}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{11} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00048 
00049  
00050 
00051 \textcolor{vhdlkeyword}{begin }
00052   
00053       clock0: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00054 \textcolor{vhdlkeyword}{    begin}
00055         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00056         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00057     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock0};
00058 
00059     clock: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00060 \textcolor{vhdlkeyword}{    begin}
00061         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00062         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00063     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock};
00064     
00065         res: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00066 \textcolor{vhdlkeyword}{    begin}
00067         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{20} \textcolor{vhdlchar}{ns};
00068         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait};
00069     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{res};
00070    
00071    
00072    
00073  \textcolor{keywordflow}{process}(clk0, reset_n)
00074 \textcolor{vhdlkeyword}{   begin}
00075       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00076          \textcolor{vhdlchar}{dut0_pct_hdr_1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00077       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00078          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{dut0_smpl_buff_rdreq} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00079             \textcolor{vhdlchar}{dut0_pct_hdr_1} \textcolor{vhdlchar}{<=} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{dut0_pct_hdr_1}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{+}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)};
00080          \textcolor{keywordflow}{else} 
00081             \textcolor{vhdlchar}{dut0_pct_hdr_1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{dut0_pct_hdr_1};
00082          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00083       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00084    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00085    
00086    
00087 
00088   
00089   dut0 : \textcolor{keywordflow}{entity} work.data2packets_top 
00090    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (
00091       smpl_buff_rdusedw_w => \textcolor{vhdllogic}{11},\textcolor{keyword}{ --bus width in bits }
00092       pct_buff_wrusedw_w  => \textcolor{vhdllogic}{12} \textcolor{keyword}{--bus width in bits  }
00093    \textcolor{vhdlchar}{)}
00094    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(              
00095       clk               => clk0,
00096       reset_n           => reset_n,
00097       sample_width      => dut0_sample_width,
00098       pct_hdr_0         => dut0_pct_hdr_0,
00099       pct_hdr_1         => dut0_pct_hdr_1,
00100       pct_buff_wrusedw  => inst2_wrusedw,
00101       pct_buff_wrreq    => dut0_pct_buff_wrreq,
00102       pct_buff_wrdata   => dut0_pct_buff_wrdata,
00103       smpl_buff_rdusedw => inst1_rdusedw,
00104       smpl_buff_rdreq   => dut0_smpl_buff_rdreq,
00105       smpl_buff_rddata  => \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}=>'0'\textcolor{vhdlchar}{)}
00106       \textcolor{vhdlchar}{)};
00107       
00108       
00109  proc\_name : \textcolor{keywordflow}{process}(clk0, reset_n)
00110 \textcolor{vhdlkeyword}{ begin}
00111     \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00112        inst1\_wrreq <= '0';
00113     \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00114        inst1\_wrreq <= \textcolor{keywordflow}{NOT} inst1\_wrreq;
00115     \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00116  \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00117       
00118       
00119 fifo\_inst\_inst1 : \textcolor{keywordflow}{entity} work.fifo_inst
00120   \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (
00121       dev_family        => \textcolor{keyword}{"Cyclone IV E"}  ,
00122       wrwidth         => \textcolor{vhdllogic}{48},
00123       wrusedw_witdth  => \textcolor{vhdllogic}{11},\textcolor{keyword}{ --12=2048 words }
00124       rdwidth         => \textcolor{vhdllogic}{48},
00125       rdusedw_width   => \textcolor{vhdllogic}{11},
00126       show_ahead      => \textcolor{keyword}{"OFF"}
00127   \textcolor{vhdlchar}{)} 
00128   \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00129 \textcolor{keyword}{      --input ports }
00130       reset_n       => reset_n,
00131       wrclk         => clk0,
00132       wrreq         => inst1_wrreq,
00133       data          => inst1_data,
00134       wrfull        => \textcolor{keywordflow}{open},
00135         wrempty       => \textcolor{keywordflow}{open},
00136       wrusedw       => \textcolor{keywordflow}{open},
00137       rdclk          => clk0,
00138       rdreq         => dut0_smpl_buff_rdreq,
00139       q             => inst1_q,
00140       rdempty       => \textcolor{keywordflow}{open},
00141       rdusedw       => inst1_rdusedw
00142         \textcolor{vhdlchar}{)};
00143         
00144         
00145 fifo\_inst\_inst2 : \textcolor{keywordflow}{entity} work.fifo_inst
00146   \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (
00147       dev_family        => \textcolor{keyword}{"Cyclone IV E"}  ,
00148       wrwidth         => \textcolor{vhdllogic}{64},
00149       wrusedw_witdth  => \textcolor{vhdllogic}{12},\textcolor{keyword}{ --12=2048 words }
00150       rdwidth         => \textcolor{vhdllogic}{64},
00151       rdusedw_width   => \textcolor{vhdllogic}{12},
00152       show_ahead      => \textcolor{keyword}{"OFF"}
00153   \textcolor{vhdlchar}{)} 
00154   \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00155 \textcolor{keyword}{      --input ports }
00156       reset_n       => reset_n,
00157       wrclk         => clk0,
00158       wrreq         => dut0_pct_buff_wrreq,
00159       data          => dut0_pct_buff_wrdata,
00160       wrfull        => \textcolor{keywordflow}{open},
00161         wrempty       => \textcolor{keywordflow}{open},
00162       wrusedw       => inst2_wrusedw,
00163       rdclk          => clk0,
00164       rdreq         => '0',
00165       q             => \textcolor{keywordflow}{open},
00166       rdempty       => \textcolor{keywordflow}{open},
00167       rdusedw       => \textcolor{keywordflow}{open}
00168         \textcolor{vhdlchar}{)};
00169     
00170     \textcolor{keywordflow}{end} \textcolor{vhdlchar}{tb\_behave};
00171   
00172   
00173 
00174 
00175   
\end{DoxyCode}
