\subsection{packets2data.\+vhd}
\label{packets2data_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/synth/packets2data.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/synth/packets2data.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00002 \textcolor{keyword}{-- FILE:    packets2data.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION: Reads data from packets.}
00004 \textcolor{keyword}{-- DATE:    April 03, 2017}
00005 \textcolor{keyword}{-- AUTHOR(s):   Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00008 
00009 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00010 \textcolor{keyword}{-- Notes:}
00011 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00012 
00013 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00014 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00015 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00016 
00017 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00018 \textcolor{keyword}{-- Entity declaration}
00019 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00020 \textcolor{keywordflow}{entity }packets2data \textcolor{keywordflow}{is}
00021    \textcolor{keywordflow}{generic} \textcolor{vhdlchar}{(}
00022       \textcolor{vhdlchar}{dev_family}        \textcolor{vhdlchar}{:} \textcolor{comment}{string} \textcolor{vhdlchar}{:=} \textcolor{keyword}{"Cyclone IV E"};
00023       \textcolor{vhdlchar}{pct_size_w}        \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{16};
00024       \textcolor{vhdlchar}{n_buff}            \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{4};\textcolor{keyword}{ -- 2,4 valid values}
00025       \textcolor{vhdlchar}{in_pct_data_w}     \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{32};
00026       \textcolor{vhdlchar}{out_pct_data_w}    \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{32}
00027    \textcolor{vhdlchar}{)};
00028    \textcolor{keywordflow}{port} \textcolor{vhdlchar}{(}
00029 
00030       \textcolor{vhdlchar}{wclk}              \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00031       \textcolor{vhdlchar}{rclk}              \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00032       \textcolor{vhdlchar}{reset_n}           \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00033 \textcolor{keyword}{      --Mode settings}
00034       \textcolor{vhdlchar}{mode}                \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- JESD207: 1; TRXIQ: 0}
00035       \textcolor{vhdlchar}{trxiqpulse}          \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- trxiqpulse on: 1; trxiqpulse off: 0}
00036         \textcolor{vhdlchar}{ddr_en}            \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- DDR: 1; SDR: 0}
00037         \textcolor{vhdlchar}{mimo_en}           \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- SISO: 1; MIMO: 0}
00038         \textcolor{vhdlchar}{ch_en}                 \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};\textcolor{keyword}{ --"01" - Ch. A, "10" - Ch. B, "11" - Ch. A
       and Ch. B.  }
00039       \textcolor{vhdlchar}{sample_width}      \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};\textcolor{keyword}{ --"10"-12bit, "01"-14bit, "00"-16bit;}
00040       
00041       \textcolor{vhdlchar}{pct_size}          \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)}; 
00042       
00043       \textcolor{vhdlchar}{pct_sync_dis}      \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00044       \textcolor{vhdlchar}{sample_nr}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00045 
00046       \textcolor{vhdlchar}{in_pct_wrreq}      \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00047       \textcolor{vhdlchar}{in_pct_data}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{in_pct_data_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00048       \textcolor{vhdlchar}{in_pct_last}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic};
00049       \textcolor{vhdlchar}{in_pct_full}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic};
00050       \textcolor{vhdlchar}{in_pct_clr_flag}   \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic};
00051       \textcolor{vhdlchar}{in_pct_buff_rdy}   \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00052       
00053       \textcolor{vhdlchar}{smpl_buff_full}    \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00054       \textcolor{vhdlchar}{smpl_buff_q}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{out_pct_data_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00055       \textcolor{vhdlchar}{smpl_buff_valid}   \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic}
00056       
00057         \textcolor{vhdlchar}{)};
00058 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{packets2data};
00059 
00060 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00061 \textcolor{keyword}{-- Architecture}
00062 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00063 \textcolor{keywordflow}{architecture} arch \textcolor{keywordflow}{of} packets2data is
00064 \textcolor{keyword}{--declare signals,  components here}
00065 
00066 \textcolor{keyword}{--inst0}
00067 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_0}        \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00068 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_0_valid}  \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00069 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_1}        \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00070 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_1_valid}  \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00071 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_data}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{in_pct_data_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00072 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_data_wrreq}   \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00073 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_buff_rdy}     \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00074 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_in_pct_wrfull}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00075 
00076 
00077 \textcolor{keyword}{--for clk domain crosing}
00078 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_sync_dis_rclk}            \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00079 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_0_rclk}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00080 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_0_rclk_stage0}  \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00081 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_0_valid_rclk}   \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00082 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_1_rclk}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00083 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_1_rclk_stage0}  \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00084 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst0_pct_hdr_1_valid_rclk}   \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00085 
00086 \textcolor{keyword}{--inst1}
00087 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_pct_buff_rdy}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00088 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_pct_data_clr_n}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00089 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_pct_data_clr}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00090 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst1_pct_data_clr_dis}       \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00091 
00092 \textcolor{keyword}{--inst2}
00093 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{isnt2_pct_buff_rd_en}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00094 
00095 \textcolor{keyword}{--inst3}
00096 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst3_pct_data_rdreq}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00097 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst3_pct_data_rdstate}       \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00098 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst3_pct_size}               \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)}; 
00099 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{inst3_rd_fsm_rd_hold}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00100 
00101 \textcolor{keyword}{--instx}
00102 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{instx_wrempty}                \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00103 \textcolor{keywordflow}{type} \textcolor{vhdlchar}{instx_rdusedw_array} \textcolor{keywordflow}{is} \textcolor{keywordflow}{array} \textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{of} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{9} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00104 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{instx_rdusedw}                \textcolor{vhdlchar}{:} \textcolor{vhdlchar}{instx_rdusedw_array};
00105 \textcolor{keywordflow}{type} \textcolor{vhdlchar}{instx_q_array} \textcolor{keywordflow}{is} \textcolor{keywordflow}{array} \textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{of} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00106 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{instx_q}                      \textcolor{vhdlchar}{:} \textcolor{vhdlchar}{instx_q_array};
00107 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{instx_q_valid}                \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00108 
00109 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_smpl_mux}                 \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00110 
00111 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_buff_rdy_int}             \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00112 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_size_only_data}           \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00113 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{half_pct_size_only_data}      \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00114 
00115 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{smpl_buff_valid_int}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00116 
00117 
00118   
00119 \textcolor{vhdlkeyword}{begin}
00120 
00121 
00122 \textcolor{keyword}{--inst0\_pct\_hdr\_0 bus is changed once per packet, safe to use sync registers }
00123 bus\_sync\_reg0 : \textcolor{keywordflow}{entity} work.bus_sync_reg
00124  \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (\textcolor{vhdllogic}{64}\textcolor{vhdlchar}{)} 
00125  \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(rclk, '1', inst0_pct_hdr_0, inst0_pct_hdr_0_rclk_stage0\textcolor{vhdlchar}{)};
00126 
00127 bus\_sync\_reg1 : \textcolor{keywordflow}{entity} work.bus_sync_reg
00128  \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (\textcolor{vhdllogic}{64}\textcolor{vhdlchar}{)} 
00129  \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(rclk, '1', inst0_pct_hdr_0_rclk_stage0, inst0_pct_hdr_0_rclk\textcolor{vhdlchar}{)};
00130  
00131  
00132  \textcolor{vhdlchar}{gen\_handshake\_sync\_0}  \textcolor{vhdlchar}{:} 
00133    \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{generate} 
00134       handake\_sync\_insx : \textcolor{keywordflow}{entity} work.handshake_sync \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}
00135          (wclk, 
00136          reset_n, 
00137          inst0_pct_hdr_0_valid\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}, 
00138          \textcolor{keywordflow}{open}, 
00139          rclk, 
00140          reset_n, 
00141          inst0_pct_hdr_0_valid_rclk\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}
00142       \textcolor{vhdlchar}{)};
00143   \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{gen\_handshake\_sync\_0};
00144   
00145 \textcolor{keyword}{-- bus\_sync\_reg1 : entity work.bus\_sync\_reg}
00146 \textcolor{keyword}{ -- generic map (n\_buff) }
00147 \textcolor{keyword}{-- port map(rclk, '1', (others=>'1'), inst0\_pct\_hdr\_0\_valid\_rclk);}
00148 
00149 \textcolor{keyword}{--inst0\_pct\_hdr\_1 bus is changed once per packet, safe to use sync registers }
00150  bus\_sync\_reg2 : \textcolor{keywordflow}{entity} work.bus_sync_reg
00151  \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (\textcolor{vhdllogic}{64}\textcolor{vhdlchar}{)} 
00152  \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(rclk, '1', inst0_pct_hdr_1, inst0_pct_hdr_1_rclk_stage0\textcolor{vhdlchar}{)};
00153  
00154  bus\_sync\_reg3 : \textcolor{keywordflow}{entity} work.bus_sync_reg
00155  \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (\textcolor{vhdllogic}{64}\textcolor{vhdlchar}{)} 
00156  \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(rclk, '1', inst0_pct_hdr_1_rclk_stage0, inst0_pct_hdr_1_rclk\textcolor{vhdlchar}{)};
00157  
00158  
00159   \textcolor{vhdlchar}{gen\_handshake\_sync\_1}  \textcolor{vhdlchar}{:} 
00160    \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{generate} 
00161       handake\_sync\_insx : \textcolor{keywordflow}{entity} work.handshake_sync \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}
00162          (wclk, 
00163          reset_n, 
00164          inst0_pct_hdr_1_valid\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}, 
00165          \textcolor{keywordflow}{open}, 
00166          rclk, 
00167          reset_n, 
00168          inst0_pct_hdr_1_valid_rclk\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}
00169       \textcolor{vhdlchar}{)};
00170   \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{gen\_handshake\_sync\_1};
00171  
00172 \textcolor{keyword}{-- bus\_sync\_reg3 : entity work.bus\_sync\_reg}
00173 \textcolor{keyword}{ -- generic map (n\_buff) }
00174 \textcolor{keyword}{-- port map(rclk, '1', (others=>'1'), inst0\_pct\_hdr\_1\_valid\_rclk);}
00175 
00176 sync\_reg1 : \textcolor{keywordflow}{entity} work.sync_reg 
00177 \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(rclk, '1', pct_sync_dis, pct_sync_dis_rclk\textcolor{vhdlchar}{)};
00178 
00179 
00180 \textcolor{keywordflow}{process}(rclk, reset_n)
00181 \textcolor{vhdlkeyword}{begin}
00182    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00183       \textcolor{vhdlchar}{pct_size_only_data} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00184    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00185       \textcolor{vhdlchar}{pct_size_only_data} \textcolor{vhdlchar}{<=} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{4};
00186    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00187 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00188 
00189 \textcolor{keywordflow}{process}(rclk, reset_n)
00190 \textcolor{vhdlkeyword}{begin}
00191    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00192       \textcolor{vhdlchar}{half_pct_size_only_data} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00193    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00194       \textcolor{vhdlchar}{half_pct_size_only_data} \textcolor{vhdlchar}{<=} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{vhdlchar}{&} \textcolor{vhdlchar}{pct_size_only_data}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_size_w}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)};
00195    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00196 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00197 
00198 inst3\_pct\_size <= \textcolor{comment}{std\_logic\_vector}(half\_pct\_size\_only\_data);
00199 
00200 
00201 \textcolor{keywordflow}{process}(rclk, reset_n)
00202 \textcolor{vhdlkeyword}{begin}
00203    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}
00204       inst1\_pct\_data\_clr <= (others=>'0');
00205       \textcolor{vhdlchar}{in_pct_clr_flag} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00206    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00207       \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{loop}
00208          inst1\_pct\_data\_clr <= \textcolor{keywordflow}{not} inst1\_pct\_data\_clr\_n;
00209       \textcolor{keywordflow}{end} \textcolor{keywordflow}{loop}; 
00210       \textcolor{keywordflow}{if} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{inst1_pct_data_clr}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{>} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{then} 
00211          \textcolor{vhdlchar}{in_pct_clr_flag} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00212       \textcolor{keywordflow}{else} 
00213          \textcolor{vhdlchar}{in_pct_clr_flag} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00214       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00215    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00216 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00217 
00218 
00219 
00220 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00221 \textcolor{keyword}{-- Write fsm instance}
00222 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00223 p2d\_wr\_fsm\_inst0 : \textcolor{keywordflow}{entity} work.p2d_wr_fsm
00224    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00225       pct_size_w        => pct_size_w,
00226       n_buff            => n_buff,
00227       in_pct_data_w     => in_pct_data_w
00228    \textcolor{vhdlchar}{)}
00229    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00230       clk               => wclk,
00231       reset_n           => reset_n,
00232       pct_size          => pct_size, 
00233       in_pct_wrreq      => in_pct_wrreq,
00234       in_pct_data       => in_pct_data,
00235       in_pct_wrfull     => inst0_in_pct_wrfull,
00236 
00237       pct_hdr_0         => inst0_pct_hdr_0,
00238       pct_hdr_0_valid   => inst0_pct_hdr_0_valid,
00239 
00240       pct_hdr_1         => inst0_pct_hdr_1,
00241       pct_hdr_1_valid   => inst0_pct_hdr_1_valid,
00242 
00243       pct_data          => inst0_pct_data,
00244       pct_data_wrreq    => inst0_pct_data_wrreq,
00245 
00246       pct_buff_rdy      => instx_wrempty     
00247         \textcolor{vhdlchar}{)};
00248         
00249 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00250 \textcolor{keyword}{-- Generated FIFO buffers}
00251 \textcolor{keyword}{-- ----------------------------------------------------------------------------        }
00252 \textcolor{vhdlchar}{gen\_fifo} \textcolor{vhdlchar}{:}
00253    \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{generate}
00254       fifo\_inst\_isntx : \textcolor{keywordflow}{entity} work.fifo_inst
00255          \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00256             dev_family      => \textcolor{keyword}{"Cyclone IV E"}  ,
00257             wrwidth         => in_pct_data_w,
00258             wrusedw_witdth  => \textcolor{vhdllogic}{11},\textcolor{keyword}{ --12=2048 words }
00259             rdwidth         => \textcolor{vhdllogic}{64},
00260             rdusedw_width   => \textcolor{vhdllogic}{10},
00261             show_ahead      => \textcolor{keyword}{"OFF"}
00262          \textcolor{vhdlchar}{)} 
00263          \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00264 \textcolor{keyword}{            --input ports }
00265             reset_n       => inst1_pct_data_clr_n\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)},
00266             wrclk         => wclk,
00267             wrreq         => inst0_pct_data_wrreq\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)},
00268             data          => inst0_pct_data,
00269             wrfull        => \textcolor{keywordflow}{open},
00270             wrempty       => instx_wrempty\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)},
00271             wrusedw       => \textcolor{keywordflow}{open},
00272             rdclk        => rclk,
00273             rdreq         => inst3_pct_data_rdreq\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)},
00274             q             => instx_q\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)},
00275             rdempty       => \textcolor{keywordflow}{open},
00276             rdusedw       => instx_rdusedw\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}          
00277             \textcolor{vhdlchar}{)};
00278 \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{gen\_fifo};
00279 
00280 
00281 \textcolor{vhdlchar}{in_pct_last} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{inst0_in_pct_wrfull};
00282 
00283 \textcolor{keywordflow}{process}(wclk, reset_n)
00284 \textcolor{vhdlkeyword}{begin}
00285    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00286       \textcolor{vhdlchar}{in_pct_full} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00287    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{wclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{wclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00288       \textcolor{keywordflow}{if} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{instx_wrempty}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{inst0_in_pct_wrfull} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00289          \textcolor{vhdlchar}{in_pct_full} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00290       \textcolor{keywordflow}{else}
00291          \textcolor{vhdlchar}{in_pct_full} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00292       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};      
00293    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00294 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00295 
00296 
00297 \textcolor{keywordflow}{process}(rclk, reset_n)
00298 \textcolor{vhdlkeyword}{begin}
00299    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00300       \textcolor{vhdlchar}{pct_buff_rdy_int} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00301    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00302       \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{loop}
00303          \textcolor{keywordflow}{if} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{instx_rdusedw}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{half_pct_size_only_data} \textcolor{keywordflow}{then} 
00304             \textcolor{vhdlchar}{pct_buff_rdy_int}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00305          \textcolor{keywordflow}{else} 
00306             \textcolor{vhdlchar}{pct_buff_rdy_int}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00307          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00308       \textcolor{keywordflow}{end} \textcolor{keywordflow}{loop};
00309    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00310 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00311 
00312 
00313 
00314 
00315 inst1\_pct\_buff\_rdy   <= pct\_buff\_rdy\_int;
00316 \textcolor{vhdlchar}{in_pct_buff_rdy}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_buff_rdy_int};
00317 
00318 
00319 p2d\_clr\_fsm\_inst1 : \textcolor{keywordflow}{entity} work.p2d_clr_fsm
00320    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00321       pct_size_w           =>  pct_size_w,
00322       n_buff               =>  n_buff
00323    \textcolor{vhdlchar}{)}
00324    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00325       clk                  => rclk,
00326       reset_n              => reset_n,
00327       pct_size             => pct_size, 
00328       
00329       smpl_nr              => sample_nr,
00330       
00331       pct_hdr_0            => inst0_pct_hdr_0_rclk,
00332       pct_hdr_0_valid      => inst0_pct_hdr_0_valid_rclk,
00333 
00334       pct_hdr_1            => inst0_pct_hdr_1_rclk,
00335       pct_hdr_1_valid      => inst0_pct_hdr_1_valid_rclk,
00336 
00337       pct_data_clr_n       => inst1_pct_data_clr_n,
00338       pct_data_clr_dis     => inst1_pct_data_clr_dis,
00339         
00340       pct_buff_rdy         => inst1_pct_buff_rdy
00341       
00342         \textcolor{vhdlchar}{)};
00343         
00344 inst1\_pct\_data\_clr\_dis <= inst3\_pct\_data\_rdstate \textcolor{keywordflow}{when} pct\_sync\_dis\_rclk = '0' \textcolor{keywordflow}{else} (others=>'1');
00345         
00346         
00347         
00348 p2d\_sync\_fsm\_inst2 : \textcolor{keywordflow}{entity} work.p2d_sync_fsm
00349    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00350       pct_size_w           =>  pct_size_w,
00351       n_buff               =>  n_buff
00352    \textcolor{vhdlchar}{)}
00353    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00354       clk                  => rclk,
00355       reset_n              => reset_n,
00356       
00357       mode                 => mode, 
00358       trxiqpulse           => trxiqpulse,   
00359       ddr_en                 => ddr_en,
00360       mimo_en                => mimo_en,    
00361       ch_en                  => ch_en,
00362       sample_width         => sample_width, 
00363       
00364       pct_size             => \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}pct_size_only_data\textcolor{vhdlchar}{)},
00365       
00366       pct_sync_dis         => pct_sync_dis_rclk,
00367       
00368       smpl_nr              => sample_nr,
00369       
00370       pct_hdr_0            => inst0_pct_hdr_0_rclk,
00371       pct_hdr_0_valid      => inst0_pct_hdr_0_valid_rclk,
00372 
00373       pct_hdr_1            => inst0_pct_hdr_1_rclk,
00374       pct_hdr_1_valid      => inst0_pct_hdr_1_valid_rclk,
00375 
00376       pct_data_clr_n       => inst1_pct_data_clr_n,
00377       pct_buff_rdy         => pct_buff_rdy_int,
00378       
00379       pct_rd_fsm_hold      => inst3_rd_fsm_rd_hold,
00380 
00381       pct_buff_rd_en       => isnt2_pct_buff_rd_en
00382       
00383         \textcolor{vhdlchar}{)};
00384         
00385         
00386 p2d\_rd\_fsm\_inst3 : \textcolor{keywordflow}{entity} work.p2d_rd_fsm
00387    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00388       pct_size_w           => pct_size_w,
00389       n_buff               => n_buff
00390    \textcolor{vhdlchar}{)}
00391    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00392       clk                  => rclk,
00393       reset_n              => reset_n,
00394       pct_size             => inst3_pct_size,
00395      
00396       pct_data_buff_full   => smpl_buff_full,
00397       pct_data_rdreq       => inst3_pct_data_rdreq,
00398       pct_data_rdstate     => inst3_pct_data_rdstate,
00399       
00400 
00401       pct_buff_rdy         => isnt2_pct_buff_rd_en,
00402       rd_fsm_rdy           => \textcolor{keywordflow}{open},
00403       rd_fsm_rd_hold       => inst3_rd_fsm_rd_hold
00404       
00405         \textcolor{vhdlchar}{)};
00406         
00407         
00408 proc\_name : \textcolor{keywordflow}{process}(rclk, reset_n)
00409 \textcolor{vhdlkeyword}{begin}
00410    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00411       instx\_q\_valid <= (others=>'0');
00412       \textcolor{vhdlchar}{smpl_buff_q} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00413       \textcolor{vhdlchar}{smpl_buff_valid} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00414    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{rclk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00415       instx\_q\_valid <= inst3\_pct\_data\_rdreq;
00416       \textcolor{vhdlchar}{smpl_buff_q} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_smpl_mux};
00417       \textcolor{vhdlchar}{smpl_buff_valid} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{smpl_buff_valid_int};
00418    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00419 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00420 
00421 \textcolor{keywordflow}{process}(instx_q_valid,instx_q)
00422 \textcolor{keywordflow}{variable} \textcolor{vhdlchar}{tmp} \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0};
00423 \textcolor{vhdlkeyword}{begin}
00424    \textcolor{vhdlchar}{tmp} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0};
00425    \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{n_buff}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{loop}
00426       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{instx_q_valid}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00427          \textcolor{vhdlchar}{tmp} \textcolor{vhdlchar}{:=} \textcolor{vhdlchar}{i};
00428       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00429       \textcolor{vhdlchar}{smpl_buff_valid_int} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{instx_q_valid}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{tmp}\textcolor{vhdlchar}{)};
00430       \textcolor{vhdlchar}{pct_smpl_mux} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{instx_q}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{tmp}\textcolor{vhdlchar}{)};
00431    \textcolor{keywordflow}{end} \textcolor{keywordflow}{loop};
00432 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00433 
00434 \textcolor{keyword}{-- smpl\_buff\_valid <= instx\_q\_valid;}
00435         
00436 
00437 
00438   
00439 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{arch};   
00440 
00441 
00442 
00443 
00444 
\end{DoxyCode}
