\subsection{smpl\+\_\+cmp.\+vhd}
\label{smpl__cmp_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/rx\+\_\+path\+\_\+top/smpl\+\_\+cmp/synth/smpl\+\_\+cmp.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/rx\+\_\+path\+\_\+top/smpl\+\_\+cmp/synth/smpl\+\_\+cmp.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00002 \textcolor{keyword}{-- FILE:          smpl\_cmp.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION:   sample compare module  }
00004 \textcolor{keyword}{-- DATE:          5:19 PM Monday, December 11, 2017}
00005 \textcolor{keyword}{-- AUTHOR(s):     Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00008 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00009 \textcolor{keyword}{--NOTES: }
00010 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00011 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00012 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00013 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00014 
00015 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00016 \textcolor{keyword}{-- Entity declaration}
00017 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00018 \textcolor{keywordflow}{entity }smpl_cmp \textcolor{keywordflow}{is}
00019    \textcolor{keywordflow}{generic}\textcolor{vhdlchar}{(}
00020       \textcolor{vhdlchar}{smpl_width}  \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{12}
00021    \textcolor{vhdlchar}{)};
00022    \textcolor{keywordflow}{port} \textcolor{vhdlchar}{(}
00023 
00024       \textcolor{vhdlchar}{clk}            \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00025       \textcolor{vhdlchar}{reset_n}        \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00026 \textcolor{keyword}{      --Mode settings}
00027       \textcolor{vhdlchar}{mode}           \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- JESD207: 1; TRXIQ: 0}
00028       \textcolor{vhdlchar}{trxiqpulse}     \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- trxiqpulse on: 1; trxiqpulse off: 0}
00029       \textcolor{vhdlchar}{ddr_en}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- DDR: 1; SDR: 0}
00030       \textcolor{vhdlchar}{mimo_en}        \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};\textcolor{keyword}{ -- MIMO: 1; SISO: 0}
00031       \textcolor{vhdlchar}{ch_en}          \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};\textcolor{keyword}{ --"01" - Ch. A, "10" - Ch. B, "11" - Ch. A and Ch.
       B.}
00032       \textcolor{vhdlchar}{fidm}           \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00033 \textcolor{keyword}{      --control and status}
00034       \textcolor{vhdlchar}{cmp_start}      \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic} \textcolor{vhdlchar}{:=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00035       \textcolor{vhdlchar}{cmp_length}     \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{:=} \textcolor{vhdlchar}{x}\textcolor{vhdllogic}{"00FF"};\textcolor{keyword}{  -- buffer length to check}
00036       \textcolor{vhdlchar}{cmp_AI}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};\textcolor{keyword}{   -- values to compare with}
00037       \textcolor{vhdlchar}{cmp_AQ}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};   
00038       \textcolor{vhdlchar}{cmp_BI}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00039       \textcolor{vhdlchar}{cmp_BQ}         \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00040       \textcolor{vhdlchar}{cmp_done}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic};\textcolor{keyword}{     -- '1' - indicates when sample compare is done}
00041       \textcolor{vhdlchar}{cmp_error}      \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic};\textcolor{keyword}{     -- '0' - no errors, '1' - captured error}
00042       \textcolor{vhdlchar}{cmp_error_cnt}  \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00043 \textcolor{keyword}{      --DIQ bus}
00044       \textcolor{vhdlchar}{diq_h}          \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00045       \textcolor{vhdlchar}{diq_l}          \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)}  
00046         \textcolor{vhdlchar}{)};
00047 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{smpl\_cmp};
00048 
00049 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00050 \textcolor{keyword}{-- Architecture}
00051 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00052 \textcolor{keywordflow}{architecture} arch \textcolor{keywordflow}{of} smpl_cmp is
00053 \textcolor{keyword}{--declare signals,  components here}
00054 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{diq_h_reg}        \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00055 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{diq_l_reg}        \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00056 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{fidm_reg}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00057 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{cmp_done_reg}     \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00058 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{cmp_start_reg}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00059 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{cmp_error_reg}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00060 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{cmp_error_cnt_reg}\textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00061 
00062 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{AI_err}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00063 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{AQ_err}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00064 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{BI_err}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00065 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{BQ_err}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00066 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{IQ_SEL_err}       \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00067 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{smpl_err}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00068 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{smpl_err_cnt}     \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00069 
00070 
00071 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{compare_cnt}      \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00072 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{wait_cnt}         \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{3} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00073 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{compare_stop}     \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00074 
00075 \textcolor{keywordflow}{type} \textcolor{vhdlchar}{state_type} \textcolor{keywordflow}{is} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{idle}\textcolor{vhdlchar}{,} \textcolor{vhdlchar}{wait\_cyc}\textcolor{vhdlchar}{,} \textcolor{vhdlchar}{compare}\textcolor{vhdlchar}{,} \textcolor{vhdlchar}{compare\_done}\textcolor{vhdlchar}{)};
00076 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{current_state}\textcolor{vhdlchar}{,} \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{:} \textcolor{vhdlchar}{state_type};
00077 
00078 
00079   
00080 \textcolor{vhdlkeyword}{begin}
00081 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00082 \textcolor{keyword}{-- Input registers}
00083 \textcolor{keyword}{-- ----------------------------------------------------------------------------  }
00084    \textcolor{keywordflow}{process}(clk, reset_n)
00085 \textcolor{vhdlkeyword}{   begin}
00086       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00087          \textcolor{vhdlchar}{diq_h_reg}         \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00088          \textcolor{vhdlchar}{diq_l_reg}         \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00089          \textcolor{vhdlchar}{fidm_reg}          \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00090          \textcolor{vhdlchar}{cmp_start_reg}     \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00091       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00092          \textcolor{vhdlchar}{diq_h_reg}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{diq_h};
00093          \textcolor{vhdlchar}{diq_l_reg}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{diq_l};
00094          \textcolor{vhdlchar}{fidm_reg}       \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{fidm};
00095          \textcolor{vhdlchar}{cmp_start_reg}  \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_start};
00096       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00097    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00098 
00099   
00100 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00101 \textcolor{keyword}{-- Compare samples}
00102 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00103    \textcolor{keywordflow}{process}(clk, reset_n)
00104 \textcolor{vhdlkeyword}{   begin}
00105       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00106          \textcolor{vhdlchar}{AI_err}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00107          \textcolor{vhdlchar}{AQ_err}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00108          \textcolor{vhdlchar}{BI_err}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00109          \textcolor{vhdlchar}{BQ_err}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00110          \textcolor{vhdlchar}{IQ_SEL_err}  \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00111          \textcolor{vhdlchar}{smpl_err}    \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00112       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00113          \textcolor{vhdlchar}{smpl_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{AI_err} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{AQ_err} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{BI_err} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{BQ_err} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{IQ_SEL_err};
00114          
00115 \textcolor{keyword}{         --compare IQ\_SEL signal}
00116          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_h_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{diq_l_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00117             \textcolor{vhdlchar}{IQ_SEL_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00118          \textcolor{keywordflow}{else} 
00119             \textcolor{vhdlchar}{IQ_SEL_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00120          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00121          
00122 \textcolor{keyword}{         --compare ch. A samples}
00123          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_h_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{fidm_reg} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{diq_l_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{
      fidm_reg} \textcolor{keywordflow}{then} 
00124 \textcolor{keyword}{            --AI}
00125             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_l_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{cmp_AI} \textcolor{keywordflow}{then} 
00126                \textcolor{vhdlchar}{AI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00127             \textcolor{keywordflow}{else} 
00128                \textcolor{vhdlchar}{AI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00129             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00130 \textcolor{keyword}{            --AQ}
00131             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_h_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{cmp_AQ} \textcolor{keywordflow}{then} 
00132                \textcolor{vhdlchar}{AQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00133             \textcolor{keywordflow}{else} 
00134                \textcolor{vhdlchar}{AQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00135             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};         
00136          \textcolor{keywordflow}{else} 
00137             \textcolor{vhdlchar}{AI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{AI_err};
00138             \textcolor{vhdlchar}{AQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{AQ_err};
00139          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00140          
00141 \textcolor{keyword}{         --compare ch. B samples}
00142          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_h_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{/=} \textcolor{vhdlchar}{fidm_reg} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{diq_l_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{/=} \textcolor{vhdlchar}{
      fidm_reg} \textcolor{keywordflow}{then} 
00143 \textcolor{keyword}{            --BI}
00144             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_l_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{cmp_BI} \textcolor{keywordflow}{then} 
00145                \textcolor{vhdlchar}{BI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00146             \textcolor{keywordflow}{else} 
00147                \textcolor{vhdlchar}{BI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00148             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00149 \textcolor{keyword}{            --BQ}
00150             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{diq_h_reg}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_width}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{cmp_BQ} \textcolor{keywordflow}{then} 
00151                \textcolor{vhdlchar}{BQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00152             \textcolor{keywordflow}{else} 
00153                \textcolor{vhdlchar}{BQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00154             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};  
00155          \textcolor{keywordflow}{else} 
00156             \textcolor{vhdlchar}{BI_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{BI_err};
00157             \textcolor{vhdlchar}{BQ_err} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{BQ_err};
00158          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00159       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00160    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00161    
00162 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00163 \textcolor{keyword}{-- Counter}
00164 \textcolor{keyword}{-- ----------------------------------------------------------------------------  }
00165    \textcolor{keywordflow}{process}(clk, reset_n)
00166 \textcolor{vhdlkeyword}{   begin}
00167       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00168          \textcolor{vhdlchar}{compare_cnt}    \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00169          \textcolor{vhdlchar}{compare_stop}   \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00170       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00171          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare} \textcolor{keywordflow}{then} 
00172             \textcolor{vhdlchar}{compare_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{compare_cnt} \textcolor{vhdlchar}{+} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1};
00173          \textcolor{keywordflow}{else} 
00174             \textcolor{vhdlchar}{compare_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00175          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00176          
00177          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{compare_cnt} \textcolor{vhdlchar}{>} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{cmp_length}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{-} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{then} 
00178             \textcolor{vhdlchar}{compare_stop} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00179          \textcolor{keywordflow}{else} 
00180             \textcolor{vhdlchar}{compare_stop} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00181          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00182          
00183       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00184    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process}; 
00185      
00186    \textcolor{keywordflow}{process}(clk, reset_n)
00187 \textcolor{vhdlkeyword}{   begin}
00188       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00189          \textcolor{vhdlchar}{wait_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00190       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00191          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{wait\_cyc} \textcolor{keywordflow}{then} 
00192             \textcolor{vhdlchar}{wait_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{wait_cnt} \textcolor{vhdlchar}{+} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1};
00193          \textcolor{keywordflow}{else} 
00194             \textcolor{vhdlchar}{wait_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00195          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00196       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00197    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00198    
00199    \textcolor{keywordflow}{process}(clk, reset_n)
00200 \textcolor{vhdlkeyword}{   begin}
00201       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00202          \textcolor{vhdlchar}{smpl_err_cnt}   \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00203          \textcolor{vhdlchar}{cmp_error_cnt_reg}  \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00204       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00205          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare} \textcolor{keywordflow}{then} 
00206             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{smpl_err} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00207                \textcolor{vhdlchar}{smpl_err_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{smpl_err_cnt} \textcolor{vhdlchar}{+} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1};
00208             \textcolor{keywordflow}{else} 
00209                \textcolor{vhdlchar}{smpl_err_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{smpl_err_cnt};
00210             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00211          \textcolor{keywordflow}{else} 
00212             \textcolor{vhdlchar}{smpl_err_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00213          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00214          
00215          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare\_done} \textcolor{keywordflow}{then} 
00216             \textcolor{vhdlchar}{cmp_error_cnt_reg} \textcolor{vhdlchar}{<=} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{smpl_err_cnt}\textcolor{vhdlchar}{)};
00217          \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare} \textcolor{keywordflow}{then} 
00218             \textcolor{vhdlchar}{cmp_error_cnt_reg}  \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00219          \textcolor{keywordflow}{else} 
00220             \textcolor{vhdlchar}{cmp_error_cnt_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_error_cnt_reg};
00221          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00222              
00223       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00224    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00225    
00226    
00227 
00228 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00229 \textcolor{keyword}{--state machine}
00230 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00231 fsm\_f : \textcolor{keywordflow}{process}(clk, reset_n)\textcolor{keywordflow}{begin}
00232     \textcolor{keywordflow}{if}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)}\textcolor{keywordflow}{then}
00233         \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{idle};
00234     \textcolor{keywordflow}{elsif}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{and} \textcolor{vhdlchar}{clk} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)}\textcolor{keywordflow}{then} 
00235         \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{next_state};
00236     \textcolor{keywordflow}{end} \textcolor{keywordflow}{if}; 
00237 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00238 
00239 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00240 \textcolor{keyword}{--state machine combo}
00241 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00242 fsm : \textcolor{keywordflow}{process}(current_state, cmp_start, cmp_start_reg, compare_stop, smpl_err, 
      wait_cnt) \textcolor{keywordflow}{begin}
00243     \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{current_state};
00244     \textcolor{keywordflow}{case} \textcolor{vhdlchar}{current_state} \textcolor{keywordflow}{is}
00245       
00246         \textcolor{keywordflow}{when} \textcolor{vhdlchar}{idle} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{keyword}{                     -- wait for start}
00247          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{cmp_start} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{cmp_start_reg} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00248             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{wait\_cyc};
00249          \textcolor{keywordflow}{else}
00250             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{idle};
00251          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00252          
00253       \textcolor{keywordflow}{when} \textcolor{vhdlchar}{wait\_cyc} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{keyword}{                 -- wait clock cycles to capture registers and errors}
00254          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{wait_cnt} \textcolor{vhdlchar}{>} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{3} \textcolor{keywordflow}{then} 
00255             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{compare};
00256          \textcolor{keywordflow}{else} 
00257             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{wait\_cyc};
00258          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00259                 
00260       \textcolor{keywordflow}{when} \textcolor{vhdlchar}{compare} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{keyword}{                  -- state to compare samples}
00261          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{compare_stop} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{OR} \textcolor{vhdlchar}{smpl_err} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}
00262 \textcolor{keyword}{         --if compare\_stop = '1' then}
00263             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{compare\_done};
00264          \textcolor{keywordflow}{else} 
00265             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{compare};
00266          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00267        
00268       \textcolor{keywordflow}{when} \textcolor{vhdlchar}{compare\_done} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} 
00269          \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{idle};
00270            
00271         \textcolor{keywordflow}{when} \textcolor{keywordflow}{others} \textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>} 
00272             \textcolor{vhdlchar}{next_state} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{idle};
00273     \textcolor{keywordflow}{end} \textcolor{keywordflow}{case};
00274 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00275 
00276 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00277 \textcolor{keyword}{-- Output registers}
00278 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00279 \textcolor{keywordflow}{process}(clk, reset_n)
00280 \textcolor{vhdlkeyword}{begin}
00281    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00282       \textcolor{vhdlchar}{cmp_done_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00283    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00284       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare\_done} \textcolor{keywordflow}{then} 
00285          \textcolor{vhdlchar}{cmp_done_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00286       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{idle} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{cmp_start} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00287          \textcolor{vhdlchar}{cmp_done_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00288       \textcolor{keywordflow}{else} 
00289          \textcolor{vhdlchar}{cmp_done_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_done_reg};
00290       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00291    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00292 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00293 
00294 \textcolor{keywordflow}{process}(clk, reset_n)
00295 \textcolor{vhdlkeyword}{begin}
00296    \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00297       \textcolor{vhdlchar}{cmp_error_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00298    \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00299       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{smpl_err} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{and} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{compare} \textcolor{keywordflow}{then} 
00300          \textcolor{vhdlchar}{cmp_error_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00301       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{current_state} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{idle} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{cmp_start} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{keywordflow}{then} 
00302          \textcolor{vhdlchar}{cmp_error_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00303       \textcolor{keywordflow}{else} 
00304          \textcolor{vhdlchar}{cmp_error_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_error_reg};
00305       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00306    \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00307 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00308 
00309 
00310 
00311 \textcolor{vhdlchar}{cmp_done}       \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_done_reg};
00312 \textcolor{vhdlchar}{cmp_error}      \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_error_reg};
00313 
00314 \textcolor{vhdlchar}{cmp_error_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{cmp_error_cnt_reg};
00315 
00316 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{arch};   
00317 
00318 
00319 
00320 
00321 
\end{DoxyCode}
