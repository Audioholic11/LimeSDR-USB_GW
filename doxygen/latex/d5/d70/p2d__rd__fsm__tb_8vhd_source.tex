\subsection{p2d\+\_\+rd\+\_\+fsm\+\_\+tb.\+vhd}
\label{p2d__rd__fsm__tb_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/sim/p2d\+\_\+rd\+\_\+fsm\+\_\+tb.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/sim/p2d\+\_\+rd\+\_\+fsm\+\_\+tb.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00002 \textcolor{keyword}{-- FILE:    p2d\_rd\_fsm\_tb.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION: }
00004 \textcolor{keyword}{-- DATE:    March 31, 2017}
00005 \textcolor{keyword}{-- AUTHOR(s):   Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00008 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00009 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00010 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00011 
00012 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00013 \textcolor{keyword}{-- Entity declaration}
00014 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00015 \textcolor{keywordflow}{entity }p2d_rd_fsm_tb \textcolor{keywordflow}{is}
00016 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{p2d\_rd\_fsm\_tb};
00017 
00018 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00019 \textcolor{keyword}{-- Architecture}
00020 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00021 
00022 \textcolor{keywordflow}{architecture} tb\_behave \textcolor{keywordflow}{of} p2d_rd_fsm_tb is
00023 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk0_period}   \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns};
00024 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk1_period}   \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns}; 
00025 \textcolor{keyword}{   --signals}
00026 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{,}\textcolor{vhdlchar}{clk1}        \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00027 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{reset_n}       \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic}; 
00028    
00029 \textcolor{keyword}{   --dut0 signals}
00030 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_size}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{:=}\textcolor{vhdlchar}{x}\textcolor{vhdllogic}{"0006"};
00031 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_hdr_0}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00032 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_hdr_1}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00033 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_data}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{31} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00034 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_data_wrreq}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00035 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_in_pct_wrfull}     \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00036 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_data_wrreq_delay} \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00037 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_state}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00038 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_cnt}                \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{31} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00039 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}    \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{3} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00040 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_data_buff_full} \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00041   
00042 
00043 \textcolor{vhdlkeyword}{begin }
00044   
00045       clock0: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00046 \textcolor{vhdlkeyword}{    begin}
00047         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00048         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00049     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock0};
00050 
00051     clock: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00052 \textcolor{vhdlkeyword}{    begin}
00053         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00054         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00055     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock};
00056     
00057         res: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00058 \textcolor{vhdlkeyword}{    begin}
00059         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{20} \textcolor{vhdlchar}{ns};
00060         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait};
00061     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{res};
00062    
00063    
00064 \textcolor{keywordflow}{process} \textcolor{keywordflow}{is} 
00065 \textcolor{vhdlkeyword}{begin}
00066       \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}\textcolor{vhdlchar}{<=}\textcolor{vhdllogic}{"0000"};
00067       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00068       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{rising\_edge}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{)};
00069       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{rising\_edge}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{)};
00070       \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}\textcolor{vhdlchar}{<=}\textcolor{vhdllogic}{"0001"};
00071       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{rising\_edge}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{)};
00072       \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}\textcolor{vhdlchar}{<=}\textcolor{vhdllogic}{"0000"};
00073       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{150} \textcolor{vhdlchar}{ns};
00074       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{rising\_edge}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{)};
00075       \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}\textcolor{vhdlchar}{<=}\textcolor{vhdllogic}{"0010"};
00076       \textcolor{keywordflow}{wait} \textcolor{keywordflow}{until} \textcolor{vhdlchar}{rising\_edge}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{)};
00077       \textcolor{vhdlchar}{dut0_pct_buff_o_rdy}\textcolor{vhdlchar}{<=}\textcolor{vhdllogic}{"0000"};
00078       \textcolor{keywordflow}{wait};
00079 \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00080     
00081     
00082      \textcolor{keywordflow}{process}(reset_n, clk0)
00083 \textcolor{vhdlkeyword}{    begin}
00084       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}
00085          \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00086          \textcolor{vhdlchar}{dut0_pct_data_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00087          \textcolor{vhdlchar}{dut0_pct_data_buff_full} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};         
00088       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{and} \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00089          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{dut0_in_pct_wrfull} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00090             \textcolor{vhdlchar}{dut0_pct_data_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00091 \textcolor{keyword}{            --dut0\_pct\_data\_wrreq <= NOT dut0\_pct\_data\_wrreq;}
00092          \textcolor{keywordflow}{else} 
00093             \textcolor{vhdlchar}{dut0_pct_data_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00094          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00095          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{dut0_pct_data_wrreq} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00096             \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{+} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1};
00097          \textcolor{keywordflow}{else} 
00098             \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_cnt};
00099          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00100          \textcolor{vhdlchar}{dut0_pct_data_buff_full} \textcolor{vhdlchar}{<=} \textcolor{keywordflow}{NOT} \textcolor{vhdlchar}{dut0_pct_data_buff_full};
00101 \textcolor{keyword}{         --dut0\_pct\_data\_buff\_full <= '0';}
00102         \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00103     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00104     
00105     \textcolor{vhdlchar}{dut0_pct_data}  \textcolor{vhdlchar}{<=} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_cnt}\textcolor{vhdlchar}{)};
00106    
00107 
00108   
00109   p2d\_rd\_fsm\_dut0 : \textcolor{keywordflow}{entity} work.p2d_rd_fsm
00110    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map}(
00111       pct_size_w        => \textcolor{vhdllogic}{16},
00112       n_buff            => \textcolor{vhdllogic}{4}
00113    \textcolor{vhdlchar}{)}
00114    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00115       clk                  => clk0,
00116       reset_n              => reset_n,
00117       pct_size             => dut0_pct_size, 
00118       
00119       pct_data_buff_full   => dut0_pct_data_buff_full,
00120       pct_data_rdreq       => \textcolor{keywordflow}{open},
00121       pct_data_rdstate     => \textcolor{keywordflow}{open},
00122       
00123       pct_buff_rdy         => dut0_pct_buff_o_rdy,
00124       rd_fsm_rdy           => \textcolor{keywordflow}{open}
00125       
00126       \textcolor{vhdlchar}{)};
00127     
00128     \textcolor{keywordflow}{end} \textcolor{vhdlchar}{tb\_behave};
00129   
00130   
00131 
00132 
00133   
\end{DoxyCode}
