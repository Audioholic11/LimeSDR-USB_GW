\subsection{packets2data\+\_\+top\+\_\+tb.\+vhd}
\label{packets2data__top__tb_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/sim/packets2data\+\_\+top\+\_\+tb.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/tx\+\_\+path\+\_\+top/packets2data/sim/packets2data\+\_\+top\+\_\+tb.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00002 \textcolor{keyword}{-- FILE:    packets2data\_tb.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION: }
00004 \textcolor{keyword}{-- DATE:    April 03, 2017}
00005 \textcolor{keyword}{-- AUTHOR(s):   Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00008 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00009 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00010 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00011 
00012 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00013 \textcolor{keyword}{-- Entity declaration}
00014 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00015 \textcolor{keywordflow}{entity }packets2data_top_tb \textcolor{keywordflow}{is}
00016 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{packets2data\_top\_tb};
00017 
00018 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00019 \textcolor{keyword}{-- Architecture}
00020 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00021 
00022 \textcolor{keywordflow}{architecture} tb\_behave \textcolor{keywordflow}{of} packets2data_top_tb is
00023 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk0_period}    \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns};
00024 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{clk1_period}    \textcolor{vhdlchar}{:} \textcolor{comment}{time} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{10} \textcolor{vhdlchar}{ns}; 
00025 
00026 \textcolor{keywordflow}{constant} \textcolor{vhdlchar}{smpl_nr_delay}  \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{13};
00027 \textcolor{keyword}{   --signals}
00028 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{,}\textcolor{vhdlchar}{clk1}           \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00029 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{reset_n}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic}; 
00030    
00031 \textcolor{keyword}{   --dut0 signals}
00032 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_size}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{15} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{:=}\textcolor{vhdlchar}{x}\textcolor{vhdllogic}{"000A"};
00033 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_sample_width}      \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{"01"};\textcolor{keyword}{ ----"10"-12bit, "01"-14bit,
       "00"-16bit;}
00034 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_pct_data}          \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{31} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00035 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_in_pct_wrreq}      \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00036 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_in_pct_last}       \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic};
00037 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{dut0_sample_nr}         \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00038 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_cnt}                \textcolor{vhdlchar}{:} \textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{31} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00039 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{pct_cnt_reg}            \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{31} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00040 
00041 \textcolor{keywordflow}{type} \textcolor{vhdlchar}{my_array} \textcolor{keywordflow}{is} \textcolor{keywordflow}{array} \textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{smpl_nr_delay}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{of} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{63} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00042 
00043 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{smpl_nr_array} \textcolor{vhdlchar}{:} \textcolor{vhdlchar}{my_array};
00044   
00045 
00046 \textcolor{vhdlkeyword}{begin }
00047   
00048       clock0: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00049 \textcolor{vhdlkeyword}{    begin}
00050         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00051         \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk0_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00052     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock0};
00053 
00054     clock: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00055 \textcolor{vhdlkeyword}{    begin}
00056         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00057         \textcolor{vhdlchar}{clk1} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdlchar}{clk1_period}\textcolor{vhdlchar}{/}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{2};
00058     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{clock};
00059     
00060         res: \textcolor{keywordflow}{process} \textcolor{keywordflow}{is}
00061 \textcolor{vhdlkeyword}{    begin}
00062         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait} \textcolor{keywordflow}{for} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{20} \textcolor{vhdlchar}{ns};
00063         \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; \textcolor{keywordflow}{wait};
00064     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process} \textcolor{vhdlchar}{res};
00065    
00066    
00067      \textcolor{keywordflow}{process}(reset_n, clk0)
00068 \textcolor{vhdlkeyword}{    begin}
00069       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}
00070          \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00071          \textcolor{vhdlchar}{dut0_in_pct_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}; 
00072          \textcolor{vhdlchar}{pct_cnt_reg} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)};
00073       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{and} \textcolor{vhdlchar}{clk0} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00074             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{dut0_in_pct_last}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}             
00075                \textcolor{vhdlchar}{dut0_in_pct_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'};
00076 \textcolor{keyword}{               --dut0\_in\_pct\_wrreq <= NOT dut0\_in\_pct\_wrreq;}
00077             \textcolor{keywordflow}{else} 
00078                \textcolor{vhdlchar}{dut0_in_pct_wrreq} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'};
00079             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00080          \textcolor{keywordflow}{if} \textcolor{vhdlchar}{dut0_in_pct_wrreq} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00081             \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{+} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{1};
00082          \textcolor{keywordflow}{else} 
00083             \textcolor{vhdlchar}{pct_cnt} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{pct_cnt};
00084          \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00085          \textcolor{vhdlchar}{pct_cnt_reg}\textcolor{vhdlchar}{<=} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_cnt}\textcolor{vhdlchar}{)};
00086         \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00087     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00088     
00089   
00090    \textcolor{vhdlchar}{dut0_pct_data}  \textcolor{vhdlchar}{<=} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_cnt}\textcolor{vhdlchar}{)};
00091    
00092    \textcolor{vhdlchar}{dut0_sample_nr} \textcolor{vhdlchar}{<=}\textcolor{vhdlchar}{pct_cnt_reg} \textcolor{vhdlchar}{&} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{pct_cnt}\textcolor{vhdlchar}{)};
00093    
00094    
00095    
00096    
00097    proc\_name : \textcolor{keywordflow}{process}(clk0, reset_n)
00098 \textcolor{vhdlkeyword}{   begin}
00099       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00100          \textcolor{vhdlchar}{smpl_nr_array} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{(}\textcolor{keywordflow}{others}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{>}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)};
00101       \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{AND} \textcolor{vhdlchar}{clk0}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then} 
00102          \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{smpl_nr_delay}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{loop}
00103             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{i} \textcolor{vhdlchar}{=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{then} 
00104                \textcolor{vhdlchar}{smpl_nr_array}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{dut0_sample_nr};
00105             \textcolor{keywordflow}{else} 
00106                \textcolor{vhdlchar}{smpl_nr_array}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{)} \textcolor{vhdlchar}{<=} \textcolor{vhdlchar}{smpl_nr_array}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{i}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)};
00107             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00108          \textcolor{keywordflow}{end} \textcolor{keywordflow}{loop};
00109       \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00110    \textcolor{keywordflow}{end} \textcolor{keywordflow}{process};
00111   
00112   packets2data\_top\_dut0 : \textcolor{keywordflow}{entity} work.packets2data_top
00113    \textcolor{keywordflow}{generic} \textcolor{keywordflow}{map} (
00114       dev_family        => \textcolor{keyword}{"Cyclone IV E"}  ,
00115       pct_size_w        =>  \textcolor{vhdllogic}{16},
00116       n_buff            =>  \textcolor{vhdllogic}{4},\textcolor{keyword}{ -- 2,4 valid values}
00117       in_pct_data_w     =>  \textcolor{vhdllogic}{32},
00118       out_pct_data_w    =>  \textcolor{vhdllogic}{64}
00119    \textcolor{vhdlchar}{)}
00120    \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}(
00121 
00122       wclk              => clk0,
00123       rclk              => clk1, 
00124       reset_n           => reset_n,
00125       pct_size          => dut0_pct_size,
00126       sample_width      => dut0_sample_width,
00127       
00128       pct_sync_dis      => '0',
00129       sample_nr         => smpl_nr_array\textcolor{vhdlchar}{(}smpl_nr_delay-\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)},
00130       
00131       in_pct_wrreq      => dut0_in_pct_wrreq,
00132       in_pct_data       => dut0_pct_data,
00133       in_pct_last       => dut0_in_pct_last,
00134       in_pct_full       => \textcolor{keywordflow}{open},
00135       in_pct_buff_rdy   => \textcolor{keywordflow}{open}, 
00136       
00137       smpl_buff_rdempty => \textcolor{keywordflow}{open},
00138       smpl_buff_q       => \textcolor{keywordflow}{open},    
00139       smpl_buff_rdreq   => '0'
00140         \textcolor{vhdlchar}{)};
00141       
00142     
00143     \textcolor{keywordflow}{end} \textcolor{vhdlchar}{tb\_behave};
00144   
00145   
00146 
00147 
00148   
\end{DoxyCode}
