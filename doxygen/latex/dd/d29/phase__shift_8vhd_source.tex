\subsection{phase\+\_\+shift.\+vhd}
\label{phase__shift_8vhd_source}\index{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/reg\+\_\+phase\+\_\+shift/phase\+\_\+shift.\+vhd@{/home/erik/git/dev/\+Lime\+S\+D\+R-\/\+U\+S\+B\+\_\+\+G\+W/src/reg\+\_\+phase\+\_\+shift/phase\+\_\+shift.\+vhd}}

\begin{DoxyCode}
00001 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00002 \textcolor{keyword}{-- FILE:    phase\_shift.vhd}
00003 \textcolor{keyword}{-- DESCRIPTION: describe}
00004 \textcolor{keyword}{-- DATE:    Feb 13, 2014}
00005 \textcolor{keyword}{-- AUTHOR(s):   Lime Microsystems}
00006 \textcolor{keyword}{-- REVISIONS:}
00007 \textcolor{keyword}{-- ---------------------------------------------------------------------------- }
00008 \textcolor{vhdlkeyword}{library }\textcolor{keywordflow}{ieee};
00009 \textcolor{vhdlkeyword}{use }ieee.std\_logic\_1164.\textcolor{keywordflow}{all};
00010 \textcolor{vhdlkeyword}{use }ieee.numeric\_std.\textcolor{keywordflow}{all};
00011 
00012 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00013 \textcolor{keyword}{-- Entity declaration}
00014 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00015 \textcolor{keywordflow}{entity }phase_shift \textcolor{keywordflow}{is}
00016     \textcolor{keywordflow}{generic}\textcolor{vhdlchar}{(} \textcolor{vhdlchar}{reg_chain_size} \textcolor{vhdlchar}{:} \textcolor{comment}{integer} \textcolor{vhdlchar}{:=} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{16}
00017                 \textcolor{vhdlchar}{)};
00018 
00019   \textcolor{keywordflow}{port} \textcolor{vhdlchar}{(}
00020 \textcolor{keyword}{        --input ports }
00021         \textcolor{vhdlchar}{clk}       \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00022         \textcolor{vhdlchar}{reset_n}   \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00023           \textcolor{vhdlchar}{clk_in}        \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00024           \textcolor{vhdlchar}{load_reg}  \textcolor{vhdlchar}{:} \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00025           reg\_sel   : \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic\_vector}(\textcolor{vhdllogic}{7} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{0});
00026           \textcolor{vhdlchar}{clk_out}   \textcolor{vhdlchar}{:} \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic}
00027 
00028 \textcolor{keyword}{        --output ports }
00029         
00030         \textcolor{vhdlchar}{)};
00031 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{phase\_shift};
00032 
00033 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00034 \textcolor{keyword}{-- Architecture}
00035 \textcolor{keyword}{-- ----------------------------------------------------------------------------}
00036 \textcolor{keywordflow}{architecture} arch \textcolor{keywordflow}{of} phase_shift is
00037 \textcolor{keyword}{--declare signals,  components here}
00038 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{reg_chain} \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{reg_chain_size}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00039 \textcolor{keyword}{--signal reg\_chain\_d0,  reg\_chain\_d1: std\_logic\_vector (reg\_chain\_size-1 downto 0);}
00040 \textcolor{keywordflow}{signal} \textcolor{vhdlchar}{reg_sel_int} \textcolor{vhdlchar}{:} \textcolor{comment}{std\_logic\_vector}\textcolor{vhdlchar}{(}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{7} \textcolor{keywordflow}{downto} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{)};
00041 
00042 \textcolor{keywordflow}{component} simple_reg \textcolor{keywordflow}{is}
00043   \textcolor{keywordflow}{port} (
00044 \textcolor{keyword}{        --input ports }
00045             clk      : \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00046             reset_n  : \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00047             d           : \textcolor{keywordflow}{in} \textcolor{comment}{std\_logic};
00048             q           : \textcolor{keywordflow}{out} \textcolor{comment}{std\_logic}
00049         
00050         );
00051 \textcolor{keywordflow}{end} \textcolor{keywordflow}{component}; 
00052 
00053   
00054 \textcolor{vhdlkeyword}{begin}
00055 
00056 \textcolor{vhdlchar}{gen\_reg} \textcolor{vhdlchar}{:}
00057     \textcolor{keywordflow}{for} \textcolor{vhdlchar}{i} \textcolor{keywordflow}{in} \textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{to} \textcolor{vhdlchar}{reg_chain_size}\textcolor{vhdlchar}{-}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1} \textcolor{keywordflow}{generate}
00058             \textcolor{vhdlchar}{first} \textcolor{vhdlchar}{:} \textcolor{keywordflow}{if} \textcolor{vhdlchar}{i}\textcolor{vhdlchar}{=}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{generate}  
00059                 reg0 : simple_reg \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}
00060                     (clk, 
00061                     reset_n, 
00062                     clk_in, 
00063                     reg_chain\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}
00064                     \textcolor{vhdlchar}{)};
00065             \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{first};
00066 
00067             \textcolor{vhdlchar}{other} \textcolor{vhdlchar}{:} \textcolor{keywordflow}{if} \textcolor{vhdlchar}{i}\textcolor{vhdlchar}{>}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0} \textcolor{keywordflow}{generate}
00068                 regx : simple_reg \textcolor{keywordflow}{port} \textcolor{keywordflow}{map}
00069                     (clk, 
00070                     reset_n, 
00071                     reg_chain\textcolor{vhdlchar}{(}i-\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{)}, 
00072                     reg_chain\textcolor{vhdlchar}{(}i\textcolor{vhdlchar}{)}
00073                     \textcolor{vhdlchar}{)};
00074             \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{other};
00075                 
00076 \textcolor{keywordflow}{end} \textcolor{keywordflow}{generate} \textcolor{vhdlchar}{gen\_reg};
00077 
00078 
00079 
00080 \textcolor{keyword}{--  process(reset\_n, clk)}
00081 \textcolor{keyword}{--    begin}
00082 \textcolor{keyword}{--      if reset\_n='0' then}
00083 \textcolor{keyword}{--        reg\_chain\_d0<=(others=>'0');}
00084 \textcolor{keyword}{--        reg\_chain\_d1<=(others=>'0');}
00085 \textcolor{keyword}{--      elsif (clk'event and clk = '1') then}
00086 \textcolor{keyword}{--        reg\_chain\_d0<=reg\_chain;}
00087 \textcolor{keyword}{--          reg\_chain\_d1<=reg\_chain\_d0;}
00088 \textcolor{keyword}{--      end if;}
00089 \textcolor{keyword}{--    end process;}
00090      
00091      
00092       \textcolor{keywordflow}{process}(reset_n, clk)
00093 \textcolor{vhdlkeyword}{    begin}
00094       \textcolor{keywordflow}{if} \textcolor{vhdlchar}{reset_n}\textcolor{vhdlchar}{=}\textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{0}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then}
00095             reg\_sel\_int<=(others=>'0');
00096         \textcolor{keywordflow}{elsif} \textcolor{vhdlchar}{(}\textcolor{vhdlchar}{clk}\textcolor{vhdlchar}{'}\textcolor{vhdlkeyword}{event} \textcolor{keywordflow}{and} \textcolor{vhdlchar}{clk} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'}\textcolor{vhdlchar}{)} \textcolor{keywordflow}{then}
00097             \textcolor{keywordflow}{if} \textcolor{vhdlchar}{load_reg} \textcolor{vhdlchar}{=} \textcolor{vhdlchar}{'}\textcolor{vhdllogic}{}\textcolor{vhdllogic}{1}\textcolor{vhdlchar}{'} \textcolor{keywordflow}{then} 
00098                 reg\_sel\_int<=reg\_sel;
00099             \textcolor{keywordflow}{else} 
00100                 reg\_sel\_int<=reg\_sel\_int;
00101             \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00102         \textcolor{keywordflow}{end} \textcolor{keywordflow}{if};
00103     \textcolor{keywordflow}{end} \textcolor{keywordflow}{process}; 
00104      
00105      
00106      
00107 
00108 
00109 \textcolor{keyword}{--clk\_out<=reg\_chain\_d1(to\_integer(unsigned(reg\_sel\_int)));}
00110 \textcolor{vhdlchar}{clk_out}\textcolor{vhdlchar}{<=}\textcolor{vhdlchar}{reg_chain}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{to\_integer}\textcolor{vhdlchar}{(}\textcolor{comment}{unsigned}\textcolor{vhdlchar}{(}\textcolor{vhdlchar}{reg_sel_int}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)}\textcolor{vhdlchar}{)};
00111   
00112 \textcolor{keywordflow}{end} \textcolor{vhdlchar}{arch};   
00113 
00114 
00115 
\end{DoxyCode}
